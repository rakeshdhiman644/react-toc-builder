{"version":3,"file":"index.esm.js","sources":["../src/generateToc.js","../src/TocWrapper.jsx"],"sourcesContent":["export function generateToc(contentHtml, positionAfter = 0, icon = null) {\r\n  // Default SVG icon if none provided\r\n  const defaultIcon = `\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" \r\n      viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" \r\n      stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n      <polyline points=\"6 9 12 15 18 9\"></polyline>\r\n    </svg>\r\n  `;\r\n\r\n  // If icon is an image URL, render <img>, otherwise assume SVG string\r\n  const iconHtml = icon\r\n    ? icon.trim().startsWith(\"<svg\")\r\n      ? icon\r\n      : `<img src=\"${icon}\" alt=\"toggle-icon\" width=\"18\" height=\"18\" />`\r\n    : defaultIcon;\r\n\r\n  let tocHtml = `\r\n  <style>\r\n  .rtb-toc {\r\n    border: 1px solid #ddd;\r\n    padding: 10px;\r\n    margin-bottom: 1rem;\r\n    border-radius: 4px;\r\n    display: table;\r\n    box-shadow: 0 1px 1px #0000000d;\r\n    min-width: 200px;\r\n    background: #fff;\r\n  }\r\n  .rtb-toc-header {\r\n    margin-bottom: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    gap: 10px;\r\n  }\r\n  .rtb-toc-list {\r\n    display: none;\r\n    list-style: none !important;\r\n    padding: 0;\r\n    margin: 0;\r\n  }\r\n  .rtb-toc-item {\r\n    margin-top: 5px;\r\n  }\r\n  .rtb-toc-item a {\r\n    text-decoration: none;\r\n    color: inherit;\r\n    display: block;\r\n    padding: 2px 0;\r\n    transition: color 0.2s;\r\n  }\r\n  /* Font sizing per heading depth */\r\n  .rtb-toc-item.rtb-level-2 a { font-size: 1rem; }\r\n  .rtb-toc-item.rtb-level-3 a { font-size: 0.95rem; }\r\n  .rtb-toc-item.rtb-level-4 a { font-size: 0.9rem; }\r\n  .rtb-toc-item.rtb-level-5 a { font-size: 0.85rem; }\r\n  .rtb-toc-item.rtb-level-6 a { font-size: 0.8rem; }\r\n  .rtb-toc-item a:hover, .rtb-toc-item a.active {\r\n    color: #007bff;\r\n  }\r\n  /* Indentation for nested levels */\r\n  .rtb-toc-list .rtb-toc-list {\r\n    display: block; /* Always show nested lists if parent is visible */\r\n    padding-left: 20px;\r\n    margin-top: 0;\r\n  }\r\n  .rtb-toc-number {\r\n    margin-right: 5px;\r\n    font-weight: 500;\r\n    color: #666;\r\n  }\r\n  </style>\r\n    <div class=\"rtb-toc\">\r\n      <div class=\"rtb-toc-header\">\r\n        <b>Table of Contents</b>\r\n        <button data-toc-toggle class=\"rtb-toggle-btn\" aria-label=\"Toggle TOC\" style=\"cursor:pointer; background:none; border:none; padding:0; display:flex;\">\r\n          ${iconHtml}\r\n        </button>\r\n      </div>\r\n      <ul class=\"rtb-toc-list\" style=\"display: none; list-style: none; padding: 0;\">\r\n  `;\r\n\r\n  const headingRegex = /<h([2-6])[^>]*>(.*?)<\\/h\\1>/gi;\r\n  let match;\r\n  let contentWithIds = contentHtml;\r\n  const headings = [];\r\n\r\n  // 1. Extract headings and inject IDs\r\n  while ((match = headingRegex.exec(contentHtml)) !== null) {\r\n    const level = parseInt(match[1]);\r\n    const text = match[2].replace(/<[^>]+>/g, \"\").trim();\r\n    if (!text) continue;\r\n\r\n    const id = `toc-${level}-${match.index}`;\r\n    contentWithIds = contentWithIds.replace(\r\n      match[0],\r\n      `<h${level} id=\"${id}\">${match[2]}</h${level}>`\r\n    );\r\n\r\n    headings.push({ level, text, id, children: [] });\r\n  }\r\n\r\n  // 2. Build Tree Structure\r\n  const root = { level: 0, children: [] };\r\n  const stack = [root];\r\n\r\n  headings.forEach((heading) => {\r\n    while (stack.length > 1 && stack[stack.length - 1].level >= heading.level) {\r\n      stack.pop();\r\n    }\r\n    const parent = stack[stack.length - 1];\r\n    parent.children.push(heading);\r\n    stack.push(heading);\r\n  });\r\n\r\n  // 3. Recursive Render\r\n  function renderList(items, prefix = \"\") {\r\n    if (items.length === 0) return \"\";\r\n    let html = \"\";\r\n    items.forEach((item, index) => {\r\n      const num = index + 1;\r\n      const itemLabel = prefix ? `${prefix}.${num}` : `${num}`;\r\n      const displayLabel = prefix ? itemLabel : `${itemLabel}.`;\r\n\r\n      html += `<li class=\"rtb-toc-item rtb-level-${item.level}\">\r\n        <a href=\"#${item.id}\">\r\n          <span class=\"rtb-toc-number\">${displayLabel}</span>${item.text}\r\n        </a>\r\n        ${item.children.length > 0 ? `<ul class=\"rtb-toc-list\">${renderList(item.children, itemLabel)}</ul>` : \"\"}\r\n      </li>`;\r\n    });\r\n    return html;\r\n  }\r\n\r\n  tocHtml += renderList(root.children);\r\n\r\n  tocHtml += `\r\n      </ul>\r\n    </div>\r\n  `;\r\n\r\n  // ðŸ§© Insert TOC after the nth paragraph (positionAfter)\r\n  if (positionAfter >= 0) {\r\n    const paragraphRegex = /(<p[^>]*>.*?<\\/p>)/gi;\r\n    let paragraphs = [...contentWithIds.matchAll(paragraphRegex)];\r\n\r\n    if (paragraphs.length > positionAfter) {\r\n      const targetParagraph = paragraphs[positionAfter][0];\r\n      contentWithIds = contentWithIds.replace(targetParagraph, `${targetParagraph}${tocHtml}`);\r\n    } else {\r\n      contentWithIds += tocHtml;\r\n    }\r\n  } else {\r\n    contentWithIds = tocHtml + contentWithIds;\r\n  }\r\n\r\n  return contentWithIds;\r\n}","\"use client\";\r\n\r\nimport React, { useEffect } from \"react\";\r\n\r\nexport const TocWrapper = ({ html }) => {\r\n  useEffect(() => {\r\n    const btn = document.querySelector(\".rtb-toggle-btn\");\r\n    const list = document.querySelector(\".rtb-toc-list\");\r\n    if (!btn || !list) return;\r\n\r\n    const toggle = () => {\r\n      list.style.display = list.style.display === \"none\" ? \"block\" : \"none\";\r\n    };\r\n\r\n    btn.addEventListener(\"click\", toggle);\r\n    return () => btn.removeEventListener(\"click\", toggle);\r\n  }, []);\r\n\r\n  return <div dangerouslySetInnerHTML={{ __html: html }} />;\r\n};\r\n\r\nexport default TocWrapper;"],"names":["generateToc","contentHtml","positionAfter","arguments","length","undefined","icon","defaultIcon","iconHtml","trim","startsWith","concat","tocHtml","headingRegex","match","contentWithIds","headings","exec","level","parseInt","text","replace","id","index","push","children","root","stack","forEach","heading","pop","parent","renderList","items","prefix","html","item","num","itemLabel","displayLabel","paragraphRegex","paragraphs","_toConsumableArray","matchAll","targetParagraph","TocWrapper","_ref","useEffect","btn","document","querySelector","list","toggle","style","display","addEventListener","removeEventListener","React","createElement","dangerouslySetInnerHTML","__html"],"mappings":"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"}